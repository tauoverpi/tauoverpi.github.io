<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Coins &amp; Potions</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../css/normalize.css" />
  <link rel="stylesheet" href="../css/skeleton.css" />
  <link rel="stylesheet" href="../css/site.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  		<meta charset="UTF-8">
  		<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono&display=swap" rel="stylesheet">
  		<link href="https://fonts.googleapis.com/css?family=Raleway:300,400&display=swap" rel="stylesheet">
</head>
<body>
<header id="title-block-header">
<h1 class="title">Coins &amp; Potions</h1>
</header>
<div class="container">
<p class="notice">
NOTICE: Document not complete
</p>
<div class="sourceCode" id="coins-and-potions"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="coins-and-potions-1" title="1"><span class="kw">data</span> <span class="dt">Item</span> <span class="ot">=</span> <span class="dt">Coin</span> <span class="op">|</span> <span class="dt">Potion</span></a></code></pre></div>
<p>The program consists of:</p>
<div class="sourceCode" id="cb1" data-file="src/haskell/CoinsAndPotions/CoinsAndPotions.hs"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" title="1"><span class="op">&lt;&lt;</span>modules<span class="op">-</span><span class="fu">and</span><span class="op">-</span>pragma<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="op">&lt;&lt;</span>rng<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="op">&lt;&lt;</span>coins<span class="op">-</span><span class="fu">and</span><span class="op">-</span>potions<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="op">&lt;&lt;</span>logging<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="op">&lt;&lt;</span>state<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="op">&lt;&lt;</span>messages<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="op">&lt;&lt;</span>object<span class="op">-</span>structure<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="op">&lt;&lt;</span>npc<span class="op">-</span>implementation<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="op">&lt;&lt;</span>player<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="op">&lt;&lt;</span>gameboard<span class="op">&gt;&gt;</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="op">&lt;&lt;</span>gameloop<span class="op">&gt;&gt;</span></a></code></pre></div>
<p>Full source can be found <a href="https://github.com/tauoverpi/tauoverpi.github.io/tree/master/src/haskell/CoinsAndPotions/CoinsAndPotions.hs">here</a></p>
<h3 id="rng">RNG</h3>
<p>Random number generation is handled through continuously computing a hash over an infinite cycled stream of values from <code>0</code> to <code>maxBound</code> with <code>fnv1a</code>. Since <code>rng</code> doesn’t take any influence from it’s input it’s equivalent to a pure stream.</p>
<div class="sourceCode" id="rng"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="rng-1" title="1"><span class="ot">rng ::</span> <span class="dt">Word</span> <span class="ot">-&gt;</span> <span class="dt">Stream</span> <span class="dt">Word</span></a>
<a class="sourceLine" id="rng-2" title="2">rng seed <span class="ot">=</span> count <span class="op">&gt;&gt;&gt;</span> loop offset (lift (<span class="fu">uncurry</span> fnv1a) <span class="op">&gt;&gt;&gt;</span> dup)</a>
<a class="sourceLine" id="rng-3" title="3">    <span class="kw">where</span> offset <span class="ot">=</span> <span class="dv">14695981039346656037</span></a>
<a class="sourceLine" id="rng-4" title="4">          prime <span class="ot">=</span> <span class="dv">1099511628211</span></a>
<a class="sourceLine" id="rng-5" title="5">          count <span class="ot">=</span> loop (<span class="ot">seed ::</span> <span class="dt">Word</span>) (lift \(_, s) <span class="ot">-&gt;</span> (s, s<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="rng-6" title="6">          fnv1a x hash <span class="ot">=</span> (hash <span class="ot">`xor`</span> x) <span class="op">*</span> prime</a></code></pre></div>
<h3 id="messages">Messages</h3>
<div class="sourceCode" id="messages"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="messages-1" title="1"><span class="kw">type</span> <span class="dt">Address</span> <span class="ot">=</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="messages-2" title="2"></a>
<a class="sourceLine" id="messages-3" title="3"><span class="kw">data</span> <span class="dt">Action</span></a>
<a class="sourceLine" id="messages-4" title="4"><span class="kw">data</span> <span class="dt">Message</span> <span class="ot">=</span> <span class="dt">Message</span> <span class="dt">Address</span> <span class="dt">Action</span></a></code></pre></div>
<h3 id="state">State</h3>
<div class="sourceCode" id="state"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="state-1" title="1"><span class="kw">data</span> <span class="dt">PlayerState</span> <span class="ot">=</span> <span class="dt">PS</span></a>
<a class="sourceLine" id="state-2" title="2">    {<span class="ot"> php ::</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="state-3" title="3">    ,<span class="ot"> pitems ::</span> [(<span class="dt">Item</span>, <span class="dt">Int</span>)]</a>
<a class="sourceLine" id="state-4" title="4">    ,<span class="ot"> pscore ::</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="state-5" title="5">    ,<span class="ot"> phostile ::</span> [<span class="dt">Address</span>]</a>
<a class="sourceLine" id="state-6" title="6">    ,<span class="ot"> pself ::</span> <span class="dt">Address</span></a>
<a class="sourceLine" id="state-7" title="7">    }</a></code></pre></div>
<div class="sourceCode" id="state"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="state-1" title="1"><span class="kw">data</span> <span class="dt">NPCState</span> <span class="ot">=</span> <span class="dt">ES</span></a>
<a class="sourceLine" id="state-2" title="2">    {<span class="ot"> ehp ::</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="state-3" title="3">    ,<span class="ot"> eitems ::</span> [(<span class="dt">Item</span>, <span class="dt">Int</span>)]</a>
<a class="sourceLine" id="state-4" title="4">    ,<span class="ot"> ehostile ::</span> [<span class="dt">Address</span>]</a>
<a class="sourceLine" id="state-5" title="5">    ,<span class="ot"> eself ::</span> <span class="dt">Address</span></a>
<a class="sourceLine" id="state-6" title="6">    ,<span class="ot"> erng ::</span> <span class="dt">Object</span> () <span class="dt">Word</span></a>
<a class="sourceLine" id="state-7" title="7">    }</a></code></pre></div>
<h3 id="objects">Objects</h3>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1"><span class="kw">data</span> <span class="dt">Object</span> input output <span class="ot">=</span></a>
<a class="sourceLine" id="object-structure-2" title="2">    <span class="dt">Object</span> (input <span class="ot">-&gt;</span> (<span class="dt">Object</span> input output, output))</a>
<a class="sourceLine" id="object-structure-3" title="3"></a>
<a class="sourceLine" id="object-structure-4" title="4"><span class="kw">type</span> <span class="dt">Stream</span> a <span class="ot">=</span> <span class="dt">Object</span> () a</a></code></pre></div>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1"><span class="ot">step ::</span> <span class="dt">Object</span> a b <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> (<span class="dt">Object</span> a b, b)</a>
<a class="sourceLine" id="object-structure-2" title="2">step (<span class="dt">Object</span> f) x <span class="ot">=</span> f x</a></code></pre></div>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1"><span class="ot">identity ::</span> <span class="dt">Object</span> a a</a>
<a class="sourceLine" id="object-structure-2" title="2">identity <span class="ot">=</span> <span class="dt">Object</span> \x <span class="ot">-&gt;</span> (identity, x)</a></code></pre></div>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1"><span class="ot">lift ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">Object</span> a b</a>
<a class="sourceLine" id="object-structure-2" title="2">lift fn <span class="ot">=</span> <span class="dt">Object</span> \input <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="object-structure-3" title="3">    <span class="kw">let</span> result <span class="ot">=</span> fn input</a>
<a class="sourceLine" id="object-structure-4" title="4">     <span class="kw">in</span> (lift fn, result)</a>
<a class="sourceLine" id="object-structure-5" title="5"></a>
<a class="sourceLine" id="object-structure-6" title="6"><span class="ot">animate ::</span> <span class="dt">Object</span> (<span class="dt">Object</span> a b, a) (<span class="dt">Object</span> a b, b)</a>
<a class="sourceLine" id="object-structure-7" title="7">animate <span class="ot">=</span> lift (<span class="fu">uncurry</span> step)</a></code></pre></div>
<p>Since the language of <code>Object</code> can’t make use of <code>let</code> bindings we instead have sharing through duplication of values.</p>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1"><span class="ot">dup ::</span> <span class="dt">Object</span> a (a, a)</a>
<a class="sourceLine" id="object-structure-2" title="2">dup <span class="ot">=</span> lift \x <span class="ot">-&gt;</span> (x, x)</a></code></pre></div>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1"><span class="ot">swap ::</span> <span class="dt">Object</span> (a, b) (b, a)</a>
<a class="sourceLine" id="object-structure-2" title="2">swap <span class="ot">=</span> lift \(x, y) <span class="ot">-&gt;</span> (y, x)</a>
<a class="sourceLine" id="object-structure-3" title="3"></a>
<a class="sourceLine" id="object-structure-4" title="4"><span class="ot">first ::</span> <span class="dt">Object</span> a b <span class="ot">-&gt;</span> <span class="dt">Object</span> (a, c) (b, c)</a>
<a class="sourceLine" id="object-structure-5" title="5">first w <span class="ot">=</span> loop w (lift impl)</a>
<a class="sourceLine" id="object-structure-6" title="6">    <span class="kw">where</span> impl ((input, c), w) <span class="ot">=</span></a>
<a class="sourceLine" id="object-structure-7" title="7">              <span class="kw">let</span> (w&#39;, out) <span class="ot">=</span> step w input</a>
<a class="sourceLine" id="object-structure-8" title="8">               <span class="kw">in</span> ((out, c), w&#39;)</a></code></pre></div>
<p><code>second</code> is</p>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1">second w <span class="ot">=</span> swap <span class="op">&gt;&gt;&gt;</span> first w <span class="op">&gt;&gt;&gt;</span> swap</a>
<a class="sourceLine" id="object-structure-2" title="2"></a>
<a class="sourceLine" id="object-structure-3" title="3"><span class="kw">infixr</span> <span class="dv">3</span> <span class="op">&amp;&amp;&amp;</span></a>
<a class="sourceLine" id="object-structure-4" title="4"><span class="ot">(&amp;&amp;&amp;) ::</span> <span class="dt">Object</span> a b <span class="ot">-&gt;</span> <span class="dt">Object</span> a b&#39; <span class="ot">-&gt;</span> <span class="dt">Object</span> a (b, b&#39;)</a>
<a class="sourceLine" id="object-structure-5" title="5">left <span class="op">&amp;&amp;&amp;</span> right <span class="ot">=</span> dup <span class="op">&gt;&gt;&gt;</span> first left <span class="op">&gt;&gt;&gt;</span> second right</a></code></pre></div>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1"><span class="kw">infixl</span> <span class="dv">8</span> <span class="op">&gt;&gt;&gt;</span></a>
<a class="sourceLine" id="object-structure-2" title="2"><span class="kw">infixl</span> <span class="dv">8</span> <span class="op">&lt;&lt;&lt;</span></a>
<a class="sourceLine" id="object-structure-3" title="3"><span class="ot">(&gt;&gt;&gt;) ::</span> <span class="dt">Object</span> a b <span class="ot">-&gt;</span> <span class="dt">Object</span> b c <span class="ot">-&gt;</span> <span class="dt">Object</span> a c</a>
<a class="sourceLine" id="object-structure-4" title="4">(<span class="dt">Object</span> left) <span class="op">&gt;&gt;&gt;</span> (<span class="dt">Object</span> right) <span class="ot">=</span></a>
<a class="sourceLine" id="object-structure-5" title="5">    <span class="dt">Object</span> \input <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="object-structure-6" title="6">        <span class="kw">let</span> (left&#39;, input&#39;) <span class="ot">=</span> left input</a>
<a class="sourceLine" id="object-structure-7" title="7">            (right&#39;, input&#39;&#39;) <span class="ot">=</span> right input&#39;</a>
<a class="sourceLine" id="object-structure-8" title="8">         <span class="kw">in</span> (left&#39; <span class="op">&gt;&gt;&gt;</span> right&#39;, input&#39;&#39;)</a>
<a class="sourceLine" id="object-structure-9" title="9"></a>
<a class="sourceLine" id="object-structure-10" title="10">(<span class="op">&lt;&lt;&lt;</span>) <span class="ot">=</span> <span class="fu">flip</span> (<span class="op">&gt;&gt;&gt;</span>)</a>
<a class="sourceLine" id="object-structure-11" title="11"></a>
<a class="sourceLine" id="object-structure-12" title="12">cst v <span class="ot">=</span> <span class="dt">Object</span> \_ <span class="ot">-&gt;</span> (cst v, v)</a></code></pre></div>
<div class="sourceCode" id="object-structure"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="object-structure-1" title="1"><span class="ot">loop ::</span> state <span class="ot">-&gt;</span> <span class="dt">Object</span> (a, state) (b, state) <span class="ot">-&gt;</span> <span class="dt">Object</span> a b</a>
<a class="sourceLine" id="object-structure-2" title="2">loop state obj <span class="ot">=</span> <span class="dt">Object</span> \input <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="object-structure-3" title="3">    <span class="kw">let</span> (obj&#39;, (out, state&#39;)) <span class="ot">=</span> step obj (input, state)</a>
<a class="sourceLine" id="object-structure-4" title="4">     <span class="kw">in</span> (loop state&#39; obj&#39;, out)</a></code></pre></div>
<h3 id="player-npc">Player &amp; NPC</h3>
<div class="sourceCode" id="npc-implementation"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="npc-implementation-1" title="1"><span class="ot">npc ::</span> <span class="dt">NPCState</span> <span class="ot">-&gt;</span> <span class="dt">Object</span> <span class="dt">Message</span> <span class="dt">Message</span></a>
<a class="sourceLine" id="npc-implementation-2" title="2">npc config <span class="ot">=</span> loop config behaviour</a>
<a class="sourceLine" id="npc-implementation-3" title="3">    <span class="kw">where</span><span class="ot"> behaviour ::</span> <span class="dt">Object</span> (<span class="dt">Message</span>, <span class="dt">NPCState</span>) (<span class="dt">Message</span>, <span class="dt">NPCState</span>)</a>
<a class="sourceLine" id="npc-implementation-4" title="4">          behaviour <span class="ot">=</span> <span class="fu">undefined</span></a>
<a class="sourceLine" id="npc-implementation-5" title="5">          hp <span class="ot">=</span> lift (ehp <span class="op">.</span> <span class="fu">snd</span>)</a>
<a class="sourceLine" id="npc-implementation-6" title="6">          items <span class="ot">=</span> lift (eitems <span class="op">.</span> <span class="fu">snd</span>)</a>
<a class="sourceLine" id="npc-implementation-7" title="7">          hostile <span class="ot">=</span> lift (ehostile <span class="op">.</span> <span class="fu">snd</span>)</a>
<a class="sourceLine" id="npc-implementation-8" title="8">          self <span class="ot">=</span> lift (eself <span class="op">.</span> <span class="fu">snd</span>)</a>
<a class="sourceLine" id="npc-implementation-9" title="9">          <span class="co">-- rng = animate &lt;&lt;&lt; lift (erng . snd) &amp;&amp;&amp; cst ()</span></a></code></pre></div>
<div class="sourceCode" id="player"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="player-1" title="1"><span class="ot">player ::</span> <span class="dt">PlayerState</span> <span class="ot">-&gt;</span> <span class="dt">Object</span> <span class="dt">Message</span> <span class="dt">Message</span></a>
<a class="sourceLine" id="player-2" title="2">player config <span class="ot">=</span> loop config behaviour</a>
<a class="sourceLine" id="player-3" title="3">    <span class="kw">where</span><span class="ot"> behaviour ::</span> <span class="dt">Object</span> (<span class="dt">Message</span>, <span class="dt">PlayerState</span>) (<span class="dt">Message</span>, <span class="dt">PlayerState</span>)</a>
<a class="sourceLine" id="player-4" title="4">          behaviour <span class="ot">=</span> <span class="fu">undefined</span></a></code></pre></div>
<h3 id="logging">Logging</h3>
<div class="sourceCode" id="logging"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="logging-1" title="1"><span class="kw">type</span> <span class="dt">Log</span> <span class="ot">=</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a></code></pre></div>
<div class="sourceCode" id="logging"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="logging-1" title="1"><span class="ot">appendLog ::</span> <span class="dt">Log</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Log</span></a>
<a class="sourceLine" id="logging-2" title="2">appendLog <span class="fu">log</span> msg <span class="ot">=</span> <span class="fu">log</span> <span class="op">.</span> (<span class="op">++</span>msg)</a></code></pre></div>
<div class="sourceCode" id="logging"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="logging-1" title="1"><span class="ot">concatLog ::</span> <span class="dt">Log</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="logging-2" title="2">concatLog <span class="fu">log</span> <span class="ot">=</span> <span class="fu">log</span> <span class="st">&quot;&quot;</span></a></code></pre></div>
<h3 id="game-loop">Game Loop</h3>
<div class="sourceCode" id="gameboard"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="gameboard-1" title="1"><span class="ot">gameboard ::</span> [(<span class="dt">Int</span>, <span class="dt">Object</span> <span class="dt">Message</span> <span class="dt">Message</span>)]</a>
<a class="sourceLine" id="gameboard-2" title="2">gameboard <span class="ot">=</span></a>
<a class="sourceLine" id="gameboard-3" title="3">    [ (<span class="dv">0</span>, npc (<span class="dt">ES</span> <span class="dv">5</span> [(<span class="dt">Coin</span>, <span class="dv">5</span>), (<span class="dt">Potion</span>, <span class="dv">1</span>)] [] <span class="dv">0</span> (rng <span class="dv">12</span>)))</a>
<a class="sourceLine" id="gameboard-4" title="4">    , (<span class="dv">1</span>, npc (<span class="dt">ES</span> <span class="dv">6</span> [(<span class="dt">Coin</span>, <span class="dv">3</span>)] [] <span class="dv">1</span> (rng <span class="dv">13</span>)))</a>
<a class="sourceLine" id="gameboard-5" title="5">    , (<span class="dv">2</span>, npc (<span class="dt">ES</span> <span class="dv">2</span> [(<span class="dt">Potion</span>, <span class="dv">3</span>)] [] <span class="dv">2</span> (rng <span class="dv">17</span>)))</a>
<a class="sourceLine" id="gameboard-6" title="6">    , (<span class="dv">3</span>, player (<span class="dt">PS</span> <span class="dv">10</span> [] <span class="dv">0</span> [] <span class="dv">3</span>))</a>
<a class="sourceLine" id="gameboard-7" title="7">    ]</a></code></pre></div>
<div class="sourceCode" id="gameloop"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="gameloop-1" title="1"><span class="ot">game ::</span> <span class="dt">Object</span> <span class="dt">String</span> (<span class="dt">Bool</span>, <span class="dt">String</span>)</a>
<a class="sourceLine" id="gameloop-2" title="2">game <span class="ot">=</span> <span class="fu">undefined</span></a>
<a class="sourceLine" id="gameloop-3" title="3"></a>
<a class="sourceLine" id="gameloop-4" title="4"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="gameloop-5" title="5">main <span class="ot">=</span> <span class="kw">do</span> <span class="fu">putStrLn</span> <span class="st">&quot;Coins &amp; Potions v0.1.0.0&quot;</span></a>
<a class="sourceLine" id="gameloop-6" title="6">          <span class="fu">putStrLn</span> <span class="st">&quot;Enter your name.&quot;</span></a>
<a class="sourceLine" id="gameloop-7" title="7">          next game</a>
<a class="sourceLine" id="gameloop-8" title="8">    <span class="kw">where</span> next gameFrame <span class="ot">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="gameloop-9" title="9">              <span class="fu">putStr</span> <span class="st">&quot;&gt; &quot;</span></a>
<a class="sourceLine" id="gameloop-10" title="10">              hFlush stdout</a>
<a class="sourceLine" id="gameloop-11" title="11">              line <span class="ot">&lt;-</span> <span class="fu">getLine</span></a>
<a class="sourceLine" id="gameloop-12" title="12">              <span class="kw">let</span> (gameFrame&#39;, (quit, text)) <span class="ot">=</span> step gameFrame line</a>
<a class="sourceLine" id="gameloop-13" title="13">              <span class="fu">putStrLn</span> text</a>
<a class="sourceLine" id="gameloop-14" title="14">              when (<span class="fu">not</span> quit) <span class="op">$</span> next gameFrame&#39;</a></code></pre></div>
<div class="sourceCode" id="modules-and-pragma"><pre class="sourceCode hs"><code class="sourceCode haskell"><a class="sourceLine" id="modules-and-pragma-1" title="1"><span class="ot">{-# LANGUAGE BlockArguments,</span></a>
<a class="sourceLine" id="modules-and-pragma-2" title="2"><span class="ot">             RecordWildCards #-}</span></a>
<a class="sourceLine" id="modules-and-pragma-3" title="3"></a>
<a class="sourceLine" id="modules-and-pragma-4" title="4"><span class="kw">module</span> <span class="dt">Main</span> <span class="kw">where</span></a>
<a class="sourceLine" id="modules-and-pragma-5" title="5"><span class="kw">import</span> <span class="dt">Data.Bits</span> (xor)</a>
<a class="sourceLine" id="modules-and-pragma-6" title="6"><span class="kw">import</span> <span class="dt">Control.Monad</span> (when)</a>
<a class="sourceLine" id="modules-and-pragma-7" title="7"><span class="kw">import</span> <span class="dt">System.IO</span> (hFlush, stdout)</a></code></pre></div>
</div>
</body>
</html>
