<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>2020-01-12-markov-chains</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../css/normalize.css" />
  <link rel="stylesheet" href="../css/skeleton.css" />
  <link rel="stylesheet" href="../css/site.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  		<meta charset="UTF-8">
  		<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono&display=swap" rel="stylesheet">
  		<link href="https://fonts.googleapis.com/css?family=Raleway:300,400&display=swap" rel="stylesheet">
</head>
<body>
<section id="markov-chains" class="level1">
<h1>Markov Chains</h1>
<div class="sourceCode" id="hash-function"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="hash-function-1" title="1"><span class="kw">const</span> djb2_offset <span class="op">=</span> <span class="dv">5381</span><span class="op">;</span></a>
<a class="sourceLine" id="hash-function-2" title="2"><span class="kw">const</span> djb2_iter <span class="op">=</span> (hash<span class="op">,</span> item) <span class="kw">=&gt;</span> ((hash <span class="op">&lt;&lt;</span> <span class="dv">5</span>) <span class="op">+</span> hash) <span class="op">+</span> item<span class="op">;</span></a>
<a class="sourceLine" id="hash-function-3" title="3"><span class="kw">const</span> djb2 <span class="op">=</span> item <span class="kw">=&gt;</span> <span class="va">item</span>.<span class="at">reduce</span>(djb2_iter<span class="op">,</span> djb2_offset)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="markov-chain"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="markov-chain-1" title="1"><span class="kw">class</span> Markov <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-2" title="2">    <span class="at">constructor</span>() <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-3" title="3">        <span class="kw">this</span>.<span class="at">lookup</span> <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="markov-chain-4" title="4">        <span class="kw">this</span>.<span class="at">markov</span> <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="markov-chain-5" title="5">    <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-6" title="6"></a>
<a class="sourceLine" id="markov-chain-7" title="7">    <span class="at">learn</span>(text) <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-8" title="8">        <span class="kw">const</span> list <span class="op">=</span> <span class="va">text</span>.<span class="at">split</span>(<span class="st">&#39; &#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-9" title="9">        <span class="cf">if</span> (<span class="va">list</span>.<span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-10" title="10">            <span class="kw">var</span> hash <span class="op">=</span> <span class="at">djb2</span>(list[i])<span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-11" title="11">            <span class="kw">this</span>.<span class="at">lookup</span>[hash] <span class="op">=</span> list[i]<span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-12" title="12">            <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i<span class="op">+</span><span class="dv">1</span> <span class="op">&lt;</span> <span class="va">list</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-13" title="13">                <span class="kw">const</span> next <span class="op">=</span> <span class="at">djb2</span>(list[i<span class="op">+</span><span class="dv">1</span>])<span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-14" title="14">                <span class="kw">this</span>.<span class="at">lookup</span>[next] <span class="op">=</span> list[i<span class="op">+</span><span class="dv">1</span>]<span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-15" title="15">                <span class="cf">if</span> (<span class="kw">this</span>.<span class="va">markov</span>.<span class="at">hasOwnProperty</span>(hash)) <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-16" title="16">                    <span class="cf">if</span> (<span class="kw">this</span>.<span class="at">markov</span>[hash].<span class="va">next</span>.<span class="at">hasOwnPropery</span>(next)) <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-17" title="17">                        <span class="kw">this</span>.<span class="at">markov</span>[hash].<span class="at">next</span>[next] <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-18" title="18">                        <span class="kw">this</span>.<span class="at">markov</span>[hash].<span class="at">total</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-19" title="19">                    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-20" title="20">                        <span class="kw">this</span>.<span class="at">markov</span>[hash].<span class="at">next</span>[next] <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-21" title="21">                        <span class="kw">this</span>.<span class="at">markov</span>[hash].<span class="at">total</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-22" title="22">                    <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-23" title="23">                <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-24" title="24">                    <span class="kw">this</span>.<span class="at">markov</span>[hash] <span class="op">=</span> <span class="op">{</span><span class="st">&quot;total&quot;</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;next&quot;</span><span class="op">:</span> <span class="op">{</span><span class="dt">next</span><span class="op">:</span> <span class="dv">1</span><span class="op">}};</span></a>
<a class="sourceLine" id="markov-chain-25" title="25">                <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-26" title="26">                hash <span class="op">=</span> next<span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-27" title="27">            <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-28" title="28">        <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-29" title="29">    <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-30" title="30"></a>
<a class="sourceLine" id="markov-chain-31" title="31">    <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-32" title="32">        src <span class="op">+=</span> <span class="st">&quot;switch (current) {</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-33" title="33">        <span class="cf">for</span> (<span class="kw">var</span> key <span class="kw">in</span> <span class="va">Object</span>.<span class="at">keys</span>(<span class="kw">this</span>.<span class="at">markov</span>)) <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-34" title="34">            src <span class="op">+=</span> <span class="st">&quot;  case &quot;</span> <span class="op">+</span> key <span class="op">+</span> <span class="st">&quot;:</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-35" title="35">            <span class="kw">const</span> total <span class="op">=</span> <span class="va">Object</span>.<span class="at">keys</span>(<span class="kw">this</span>.<span class="at">markov</span>[key].<span class="at">total</span>)<span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-36" title="36">            <span class="cf">for</span> (<span class="kw">var</span> item <span class="kw">in</span> <span class="va">Object</span>.<span class="at">keys</span>(<span class="kw">this</span>.<span class="at">markov</span>[key].<span class="at">next</span>)) <span class="op">{</span></a>
<a class="sourceLine" id="markov-chain-37" title="37">                src <span class="op">+=</span> <span class="st">&quot;    if acc &gt;= picked { current = next; break; }</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-38" title="38">                src <span class="op">+=</span> <span class="st">&quot;    acc += freq;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-39" title="39">            <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-40" title="40">            src <span class="op">+=</span> <span class="st">&quot;    break;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-41" title="41">        <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-42" title="42">        src <span class="op">+=</span> <span class="st">&quot;  default: break;</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-43" title="43">        src <span class="op">+=</span> <span class="st">&quot;}&quot;</span></a>
<a class="sourceLine" id="markov-chain-44" title="44">        <span class="cf">return</span> src<span class="op">;</span></a>
<a class="sourceLine" id="markov-chain-45" title="45">    <span class="op">}</span></a>
<a class="sourceLine" id="markov-chain-46" title="46"><span class="op">}</span></a></code></pre></div>
<div class="sourceCode" id="cb1" data-file="src/javascript/MarkovChains/mark.js"><pre class="sourceCode js"><code class="sourceCode javascript"></code></pre></div>
</section>
</body>
</html>
